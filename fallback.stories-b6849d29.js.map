{"version":3,"file":"fallback.stories-b6849d29.js","sources":["../stories/fallback.stories.mdx"],"sourcesContent":["import '@power-elements/codesandbox-button';\nimport '../stripe-elements';\nimport '@power-elements/json-viewer';\n\nimport { ifDefined } from 'lit-html/directives/if-defined';\n\nimport { LitElement, css } from 'lit-element';\n\nimport { html, Meta, Story, Preview } from '@open-wc/demoing-storybook';\n\nimport { $, $$, publishableKey, setKeys } from './storybook-helpers.js';\n\n<Meta\n  title=\"Fallback to Stripe Elements\"\n  parameters={{ options: { selectedPanel: 'storybookjs/docs/panel' } }}\n/>\n\n# Fallback to Stripe Elements\n\nYou might often want to show users a `<stripe-payment-request>` button if they\nare able (i.e. if `canMakePayment` is true), but fall back to a\n`<stripe-elements>` card form if they are not.\n\nTo accomplish this, listen for the `unsupported` and `ready` events on\n`<stripe-payment-request>`, which fire when the element is finally unable or\nable to display a Payment Request button, respectively.\n\nWe recommend that you don't set `publishable-key` on `<stripe-elements>` until\n`unsupported` fires from `<stripe-payment-request>`, as setting the publishable\nkey will kick off the element's initialization, even if payment request is\nsupported.\n\nEnter your publishable key here (use the test key, not the production key) to\nrun the examples against your Stripe account.\n\n<Story name=\"Enter a Publishable Key\" height=\"80px\">\n  {html`\n    <mwc-textfield id=\"publishable-key-input\"\n        outlined\n        helperpersistent\n        label=\"Publishable Key\"\n        helper=\"NOTE: the input will store the publishable key in localstorage for your convenience.\"\n        value=\"${publishableKey}\"\n        @change=\"${setKeys('fallback-form')}\">\n    </mwc-textfield>`\n  }\n</Story>\n\n<Preview>\n  <Story name=\"Falling Back to Stripe Elements When Payment Request is Not Supported\">\n    {\n      () => {\n        if (!customElements.get('fallback-form')) {\n          customElements.define('fallback-form', class PaymentForm extends LitElement {\n            static get properties() {\n              return {\n                error: { type: Object },\n                output: { type: Object },\n                unsupported: { type: Boolean },\n                publishableKey: { type: String, attribute: 'publishable-key' },\n                submitDisabled: { type: Boolean },\n              }\n            }\n            static get styles() {\n              return css`\n              [hidden] { display: none !important; }\n              :host {\n                font-family: \"Nunito Sans\", -apple-system, \".SFNSText-Regular\", \"San Francisco\", BlinkMacSystemFont, \"Segoe UI\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n                align-items: center;\n                display: grid;\n                grid-gap: 12px;\n                grid-template-areas:\n                  'support support'\n                  'stripe submit'\n                  'output output';\n              }\n              stripe-elements { grid-area: stripe; }\n              stripe-payment-request { grid-area: submit/stripe/stripe/submit; }\n              mwc-button { grid-area: submit; }\n              json-viewer { grid-area: output; }\n              `;\n            }\n            constructor() {\n              super();\n              this.submitDisabled = true;\n            }\n            render() {\n              return html`\n                <output ?hidden=\"${this.unsupported === undefined}\">Payment Request is ${this.unsupported ? 'un' : ''}supported on this Browser</output>\n                <stripe-payment-request\n                    ?hidden=\"${this.output || this.unsupported}\"\n                    @success=\"${this.onSuccess}\"\n                    @fail=\"${this.onFail}\"\n                    @error=\"${this.onError}\"\n                    @unsupported=\"${this.onUnsupported}\"\n                    @ready=\"${this.onReady}\"\n                    publishable-key=\"${ifDefined(this.publishableKey)}\"\n                    generate=\"source\"\n                    request-payer-name\n                    request-payer-email\n                    request-payer-phone\n                    amount=\"326\"\n                    label=\"Double Double\"\n                    country=\"CA\"\n                    currency=\"cad\">\n                  <stripe-display-item data-amount=\"125\" data-label=\"Double Double\"> </stripe-display-item>\n                  <stripe-display-item data-amount=\"199\" data-label=\"Box of 10 Timbits\"> </stripe-display-item>\n                  <stripe-shipping-option data-id=\"pick-up\" data-label=\"Pick Up\" data-detail=\"Pick Up at Your Local Timmy's\" data-amount=\"0\"> </stripe-shipping-option>\n                  <stripe-shipping-option data-id=\"delivery\" data-label=\"Delivery\" data-detail=\"Timbits to Your Door\" data-amount=\"200\"> </stripe-shipping-option>\n                </stripe-payment-request>\n                <stripe-elements\n                    ?hidden=\"${this.output || !this.unsupported}\"\n                    generate=\"source\"\n                    publishable-key=\"${ifDefined(this.unsupported ? this.publishableKey : undefined)}\"\n                    @change=\"${this.onChange}\"\n                    @source=\"${this.onSuccess}\"\n                    @error=\"${this.onError}\"\n                > </stripe-elements>\n                <mwc-button\n                    ?hidden=\"${this.output || !this.unsupported}\"\n                    ?disabled=\"${this.submitDisabled}\"\n                    @click=\"${this.onClick}\"\n                >Submit</mwc-button>\n                <json-viewer .object=\"${this.output}\"> </json-viewer>\n              `;\n            }\n            onChange({ target: { complete, hasError } }) { this.submitDisabled = !(complete && !hasError); }\n            onClick() { this.shadowRoot.querySelector('stripe-elements').submit() }\n            onError({ target: { error } }) { this.error = error; }\n            onFail(event) { this.output = event.detail }\n            onReady() { this.unsupported = false; }\n            onSuccess(event) { this.output = event.detail }\n            onUnsupported() { this.unsupported = true; }\n          })\n        }\n        return html`<fallback-form publishable-key=\"${publishableKey}\"> </fallback-form>`;\n      }\n    }\n  </Story>\n</Preview>\n"],"names":["layoutProps","MDXContent","components","props","mdx","mdxType","Meta","title","parameters","options","selectedPanel","parentName","Story","name","height","html","publishableKey","setKeys","Preview","customElements","get","define","LitElement","error","type","Object","output","unsupported","Boolean","String","attribute","submitDisabled","css","constructor","render","undefined","this","onSuccess","onFail","onError","onUnsupported","onReady","ifDefined","onChange","onClick","target","complete","hasError","shadowRoot","querySelector","submit","event","detail","isMDXComponent","enterAPublishableKey","story","mdxSource","fallingBackToStripeElementsWhenPaymentRequestIsNotSupported","componentMeta","includeStories","mdxStoryNameToKey","docs","page","AddContext","mdxComponentMeta"],"mappings":"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"}